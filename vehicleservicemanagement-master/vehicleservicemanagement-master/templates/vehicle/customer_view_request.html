{% extends 'vehicle/customerbase.html' %}
{% load widget_tweaks %}

{% block content %}

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <title>View Customer Requests</title>
    <style media="screen">
        .request-table-container {
            max-width: 800px;
            margin: 20px auto;
            overflow-x: auto; /* For responsive table */
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        tr:nth-child(even) {background-color: #f9f9f9;}
    </style>
    <script>
document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.delete-link').forEach(function (link) {
        link.addEventListener('click', function (event) {
            event.preventDefault();
            var serviceId = this.getAttribute('data-service-id');
            deleteService(serviceId);
        });
    });
});

function deleteService(serviceId) {
    console.log('Deleting service with ID:', serviceId);
    if (confirm('Are you sure you want to delete this service?')) {
        fetch(`http://ec2-54-166-224-107.compute-1.amazonaws.com:9198/api/v1/serviceManagement/${serviceId}`, {
            method: 'DELETE',

        })
        .then(response => {
    if (!response.ok) {
        throw new Error(`Failed to delete the service. Server returned ${response.status} - ${response.statusText}`);
    }
    else {
        location.reload();

    }

})
.catch(error => {
    console.error('Error:');
    alert('Error deleting service');
});
    }
}

</script>


</head>
<body>
    <div class="request-table-container">
        <h2 style="text-align:center;">Customer Requests</h2>
        <table id="requestsTable">
            <thead>
                <tr>
                    <th>Service ID</th>
                    <th>Project Information</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Work Location</th>
                    <th>Master Agreement Name</th>
                    <th>Domain</th>
                    <th>Role</th>
                    <th>Experience</th>
                    <th>Technology</th>
                    <th>Skill</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for enquiry in enquiries %}
                <tr>
                    <td>{{ enquiry.serviceId }}</td>
                    <td>{{ enquiry.projectInfo }}</td>
                    <td>{{ enquiry.startDate }}</td>
                    <td>{{ enquiry.endDate }}</td>
                    <td>{{ enquiry.workLocation }}</td>
                    <td>{{ enquiry.masterAgreementName }}</td>
                    <td>{{ enquiry.domain }}</td>
                    <td>{{ enquiry.role }}</td>
                    <td>{{ enquiry.experience }}</td>
                    <td>{{ enquiry.technology }}</td>
                    <td>{{ enquiry.skill }}</td>
                    <td><a href="#" class="delete-link" data-service-id="{{ enquiry.serviceId }}">Delete</a></td>
                </tr>
                {% empty %}
                <tr><td colspan="12">No requests found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</body>
</html>

<!-- Replace the following script block with the provided one -->
<!-- ... Rest of your HTML ... -->



<!-- ... Rest of your HTML ... -->


{% endblock content %}
